<div class="clearfix resource-search-container">
    <div class="clearfix">
        <h1 class="col-xs-12">{{ 'resource.title' | translate }}</h1>
    </div>

    <form name="searchForm" class="form-search clearfix" role="form" ng-submit="search()" novalidate>
        <div class="col-xs-9">
            <div class="input-group">
                <input type="text" class="form-control" placeholder=" {{'resource.placeholder.search' | translate}}" ng-model="resourceSearch.name" />
                <span class="input-group-btn">
                    <button id="searchButton" type="submit" class="btn btn-primary">
                        {{'resource.searchbutton' | translate}}
                    </button>
                </span>
            </div>
        </div>
        <div class="form-group col-xs-3">
            <button type="submit" class="btn {{ resourceSearch.isFree ? 'btn-success' : 'btn-default'}}" ng-model="resourceSearch.isFree" btn-checkbox btn-checkbox-true="true" btn-checkbox-false="false">
                <span class="glyphicon {{ resourceSearch.isFree ? 'glyphicon-check' : 'glyphicon-unchecked' }}"></span> {{'resource.search.free' | translate}}
            </button>
        </div>

        <p ng-show="totalItems>0" class="col-md-12">{{totalItems}} Ressourcen gefunden</p>

        <div class="col-md-12">
            <div class="alert alert-danger" ng-show="searchError" translate="resource.error.searcherror">
                <strong>Server could not be reached, something went wrong</strong>
            </div>
        </div>
        <div class="col-md-12">
            <div class="alert alert-warning" ng-show="noResourcesFound" translate="resource.search.empty">
                <strong>There are no resources matching your criteria</strong>
            </div>
        </div>
    </form>

    <div class="col-md-12">
        <ul class="resources">
            <li class="resource row hover-toggle" ng-repeat="resource in resources">
                <div class="col-md-1">
                    <uploaded-image name="resource.logo.id"></uploaded-image>
                </div>
                <div class="pull-right col-md-7">
                    <div class="col-md-8">
                        {{ resource.description }}
                    </div>
                    <div class="col-md-4 on-hover">
                        <button ng-show="isClaimable(resource)" ng-click="claimResource(resource)" data-toggle="modal" data-target="#claimResourceModal" class="btn btn-primary" translate="resource.search.request">
                            Request resource
                        </button>
                    </div>
                </div>
                <h2 class="col-md-4">
                    {{ resource.name }}
                    <span ng-hide="resource.amount == 1">({{ resource.amount }})</span><br>
                    <sup>
                        <small>
                            {{ resource.startDate | date }} - {{ resource.endDate | date }}
                        </small>
                    </sup>
                    <div class="organization">
                        <span class="organization-name">{{ resource.organization.name }}</span>
                        <rating class="on-hover" ng-model="resource.rating" max="5" readonly="true"></rating>
                    </div>
                </h2>
            </li>
        </ul>
    </div>


    <pagination direction-links="false" max-size="5" items-per-page="filter.pageSize" total-items="totalItems" ng-model="currentPage" ng-change="onPageChange()" ng-show="totalItems>filter.pageSize"></pagination>

</div>

<div class="modal fade modal-claim" id="claimResourceModal" tabindex="-1" role="dialog" aria-labelledby="resourceModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form name="sendform" role="form" novalidate show-validation class="ng-scope ng-invalid ng-invalid-required ng-dirty ng-valid-minlength" ng-submit="create()">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="clear()">&times;</button>
                    <h3 class="modal-title" id="resourceModalLabel" translate="resource.claim.title">Claim Resource</h4>
                    </div>
                    <div class="modal-body clearfix">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="alert alert-danger" ng-show="searchError" translate="project.error.searcherror">
                                    <strong>Server could not be reached, something went wrong</strong>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="alert alert-warning" ng-show="noProjects" translate="project.search.empty">
                                    <strong>There are no projects matching your criteria</strong>
                                </div>
                            </div>
                        </div>

                        <div class="clearfix">
                            <h4 translate="resource.claim.chooseproject">choose project</h4>
                            <div class="col-sm-12 spacer-top project-overview">
                                <resp-project project="project" on-project-click="selectProject(project, $event)"
                                              ng-repeat="project in projects" tags="false"></resp-project>
                            </div>
                        </div>

                        <div class="clearfix">
                            <h4 translate="resource.claim.chooserequirement" ng-show="showRequirements">choose requirement</h4>
                            <ul class="resources spacer-top">
                                <li ng-click="selectRequirement(requirement, $event)" class="resource row" ng-repeat="requirement in resourceRequirements">
                                    <div class="col-md-2">
                                        <img src="" alt="">
                                    </div>
                                    <div class="pull-right col-md-6">
                                        {{ requirement.description }}
                                    </div>
                                    <h2 class="col-md-4">
                                        {{ requirement.name }}
                                        <span ng-hide="requirement.amount == 1">({{ requirement.amount }})</span>
                                    </h2>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="clearClaimResource()">
                            <span class="glyphicon glyphicon-ban-circle"></span>
                            <span translate="global.form.cancel">Cancel</span>
                        </button>
                        <button type="button" ng-click="sendClaimRequest()" data-dismiss="modal" ng-disabled="sendform.$invalid" class="btn btn-primary">
                            <span class="glyphicon glyphicon-save"></span>
                            <span translate="global.form.send">Send</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
