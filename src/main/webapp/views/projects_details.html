<div class="row">
    <div class="modal-header">
        <div class="alert alert-danger ng-scope" ng-show="showError()">
            <strong>{{ ProjectApply.error | translate }}</strong>
        </div>
        <button class="btn btn-primary pull-right" ng-click='edit()' translate='general.edit'>Edit</button>
        <button class="btn btn-default" ng-click="clear()" translate="general.back">Back</button>
        <h2 translate="project.details.title" translate-values="{project: '{{project.name}}'}">Project overview for {{project.name}}</h2>
    </div>
    <div class="modal-body">
        <div class="col-md-6">
            <div class="clearfix">
                <uploaded-image name="project.logo.id" class="project-logo pull-left"></uploaded-image>
                <h3 translate="project.details.purpose">Project purpose</h3>
                <div ng-bind-html="purpose"></div>
            </div>
            <div class="tags-container clear-left">
                <h3 translate="project.tags">Tags</h3>
                <tags-input ng-model="project.propertyTags" add-on-space="true" display-property="name" min-length="1" placeholder="{{'project.tags.placeholder' | translate}}">
                    <auto-complete source="getPropertyTagNames($query)" min-length="1"></auto-complete>
                </tags-input>
            </div>
            <div class="rating-container">
                <div class="row">
                    <div id="rating" class="col-md-12">
                        <span>Aktuelle Bewertung: </span>
                        <rating max="5" readonly="!canRate" on-leave="overStar = null" ng-click="showRating()" ng-model="shownRating"></rating>
                        <span>{{shownRating}}({{ratingCount}})</span>
                    </div>
                </div>
                <div ng-show="isRating">
                    <div class="row">
                        <div class="col-md-12">
                            <hr/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <textarea ng-model="rating.comment" cols="30" rows="5" placeholder="{{'rating.placeholder' | translate}}"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <button class="btn btn-success" ng-click="rateProject()" translate="rating.ratenow">Rate now</button>
                            <button class="btn btn-default" ng-click="hideRating()" translate="rating.notnow">Not now</button>
                        </div>
                    </div>
                </div>


            </div>
            <div class="newsfeed">
                <h2>Newsfeed</h2>
                <div class="well">
                    <ul>
                        <li>
                            <h4>Boote wurden nach Tokio transportiert <sup><small>12.12.2014</small></sup></h4>
                        </li>
                        <li>
                            <h4>Erste Demonstranten eingetroffen <sup><small>13.12.2014</small></sup></h4>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="remaining" ng-show="remainingDays >= 0 && project.concrete == true">
                <div class="col-md-2 pull-right"><strong>{{project.startDate | date}}</strong>
                </div>
                <strong>{{remainingDays}} Tage verbleiben</strong>
                <progressbar class="progress-striped" value="50"></progressbar>
            </div>
            <p class="remaining" ng-show="remainingDays == true">
                <strong translate="project.started">Project started already. Come back later to keep on track!</strong>
            </p>
            <div class="resources">
                <strong>{{collected}}% Ressourcen gesammelt</strong>
                <progressbar class="progress-striped" value="collected"></progressbar>
                <strong>{{collectedEssential}}% der notwendigen Ressourcen gesammelt</strong>
                <progressbar class="progress-striped" value="collectedEssential"></progressbar>
            </div>
            <div class="resource-requirements">
                <h2>Details</h2>
                <accordion close-others="true">
                    <accordion-group ng-open="requirement.id" ng-repeat="requirement in project.resourceRequirements">
                        <accordion-heading>
                            <div class="row">
                                <div class="col-md-8">{{requirement.name}}</div>
                                <div class="col-md-2 on-hover">
                                    <button class="btn btn-default btn-sm" ng-show="isAllowedToApply()" type="button" ng-click="projectApply(requirement, $event)" translate="resource.offer.donate" data-toggle="modal" data-target="#apply">Donate</button>
                                </div>
                                <div class="col-md-2">
                                    <span ng-show="requirement.sum != undefined">{{requirement.sum}}</span>
                                    <span ng-show="requirement.sum == undefined">0</span>/{{requirement.originalAmount}}
                                    <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open1, 'glyphicon-chevron-right': !status.open1}"></i>
                                </div>
                            </div>
                        </accordion-heading>
                        <ul>
                            <li ng-repeat="match in requirement.matches">
                                <img src="images/profile_empty.png" alt="profile-picture" class="pull-left">
                                <div class="col-md-4 strong">{{match.organization.name}}</div>
                                <div class="col-md-4 pull-right">{{match.amount}}/{{requirement.amount}}</div>
                                <div class="col-md-4">
                                    <rating max="5" readonly="!canRate" on-leave="overStar = null" ng-click="rateOrganization(match.matchId, match.organization.id)" ng-model="organizationRatings[match.organization.id]"></rating>
                                    <span>{{organizationRatingCounts[match.organization.id]}}</span>
                                </div>
                            </li>
                        </ul>
                    </accordion-group>

                </accordion>
            </div>
        </div>
    </div>

    <div class="modal fade modal-apply" id="apply" tabindex="-1" role="dialog" aria-labelledby="applyLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="clearRequirement()">&times;</button>
                    <h2 class="modal-title" id="applyLabel" translate="resource.offer.title">Choose resource offer</h2>
                </div>
                <div class="modal-body">
                    <form name="applyForm" role="form" novalidate show-validation class="ng-scope ng-invalid ng-invalid-required ng-dirty ng-valid-minlength">
                        <dl class="dl-horizontal">
                            <dt>Ausgewählte Ressource:</dt>
                            <dd>{{ selectedRequirement.name }}</dd>
                            <dt>Noch benötigte Anzahl</dt>
                            <dd>{{ selectedRequirement.amount }}</dd>
                        </dl>
                        <ul class="resources">
                            <li ng-click="selectResourceOffer(offer, $event)" class="resource row" ng-repeat="offer in resourceOffers">
                                <div class="col-md-2">
                                    <img src="" alt="">
                                </div>
                                <div class="pull-right col-md-6">
                                    {{ offer.description }}
                                </div>
                                <h2 class="col-md-4">
                                    {{ offer.name }}
                                    <span ng-hide="offer.amount == 1">({{ offer.amount }})</span>
                                </h2>
                            </li>
                        </ul>
                    </form>
                </div>
                <div class="modal-footer">
                    <button id="resourceCancelButton" type="button" class="btn btn-link" data-dismiss="modal">
                        {{ 'resource.new.cancelbutton' | translate }}
                    </button>
                    <button id="resourceSaveButton" type="button" ng-click="projectApplySubmit($event, this)" data-dismiss="modal" class="btn btn-success" ng-disabled="applyForm.$invalid">
                        <span class="glyphicon glyphicon-save"></span> {{ 'resource.new.savebutton' | translate }}
                    </button>
                </div>
                </form>
            </div>
        </div>
    </div>
</div>
